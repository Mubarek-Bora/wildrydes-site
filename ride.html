<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wild Rydes - Ride</title>
  <style>
    /* ride.css content - embedded to fix 404 error */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .ride-form {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      padding: 30px;
      width: 100%;
      max-width: 800px;
      min-height: 600px;
    }

    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 30px;
      font-size: 2.5em;
      background: linear-gradient(45deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    #rideRequest {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 20px;
      align-items: center;
    }

    #rideRequest input {
      padding: 15px 20px;
      border: 2px solid #e1e5e9;
      border-radius: 10px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: white;
    }

    #rideRequest input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      transform: translateY(-2px);
    }

    #rideRequest button {
      grid-column: 1 / -1;
      padding: 15px 30px;
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    #rideRequest button:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
    }

    #rideRequest button:active {
      transform: translateY(-1px);
    }

    #map {
      width: 100%;
      height: 400px;
      border-radius: 15px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      border: 3px solid #f8f9fa;
      overflow: hidden;
    }

    .ride-info {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      display: none;
    }

    .ride-info.active {
      display: block;
      animation: slideIn 0.5s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .status {
      text-align: center;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
      font-weight: 600;
    }

    .status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .status.info {
      background: #cce7ff;
      color: #004085;
      border: 1px solid #b3d4fc;
    }

    @media (max-width: 768px) {
      #rideRequest {
        grid-template-columns: 1fr;
      }

      .ride-form {
        padding: 20px;
        margin: 10px;
      }

      h1 {
        font-size: 2em;
      }

      #map {
        height: 300px;
      }
    }
  </style>
</head>

<body>
  <div class="ride-form">
    <h1>üöó Wild Rydes</h1>
    <form id="rideRequest">
      <input id="pickup" placeholder="üìç Pickup Location" autocomplete="off" />
      <input id="dropoff" placeholder="üéØ Dropoff Location" autocomplete="off" />
      <button type="submit">üöÄ Book My Ride</button>
    </form>

    <div id="rideInfo" class="ride-info">
      <h3>üéâ Ride Booked Successfully!</h3>
      <p><strong>Pickup:</strong> <span id="confirmedPickup"></span></p>
      <p><strong>Dropoff:</strong> <span id="confirmedDropoff"></span></p>
      <p><strong>Estimated Time:</strong> <span id="estimatedTime"></span></p>
      <p><strong>Driver:</strong> <span id="driverName"></span></p>
    </div>

    <div id="map"></div>

    <div id="status"></div>
  </div>

  <script>
    // ride.js content - embedded to fix 404 error
    let map;
    let directionsService;
    let directionsRenderer;
    let pickupMarker;
    let dropoffMarker;
    let geocoder;

    // Initialize the map
    function initMap() {
      // Default location (San Francisco)
      const defaultLocation = { lat: 37.7749, lng: -122.4194 };

      // Initialize map
      map = new google.maps.Map(document.getElementById("map"), {
        zoom: 13,
        center: defaultLocation,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        styles: [
          {
            featureType: "all",
            elementType: "geometry.fill",
            stylers: [{ weight: "2.00" }]
          },
          {
            featureType: "all",
            elementType: "geometry.stroke",
            stylers: [{ color: "#9c9c9c" }]
          }
        ]
      });

      // Initialize services
      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer({
        draggable: true,
        polylineOptions: {
          strokeColor: "#667eea",
          strokeWeight: 5
        }
      });
      directionsRenderer.setMap(map);
      geocoder = new google.maps.Geocoder();

      // Initialize autocomplete for inputs
      const pickupInput = document.getElementById('pickup');
      const dropoffInput = document.getElementById('dropoff');

      const pickupAutocomplete = new google.maps.places.Autocomplete(pickupInput);
      const dropoffAutocomplete = new google.maps.places.Autocomplete(dropoffInput);

      pickupAutocomplete.bindTo('bounds', map);
      dropoffAutocomplete.bindTo('bounds', map);

      // Add click listener to map for setting pickup/dropoff
      map.addListener("click", (event) => {
        handleMapClick(event.latLng);
      });

      console.log("üéâ Wild Rydes map initialized successfully!");
      showStatus("üó∫Ô∏è Map loaded! Click on the map or enter addresses to set pickup/dropoff locations.", "info");
    }

    // Handle map clicks
    function handleMapClick(location) {
      const pickupInput = document.getElementById('pickup');
      const dropoffInput = document.getElementById('dropoff');

      if (!pickupInput.value) {
        setPickupLocation(location);
        geocodeLocation(location, (address) => {
          pickupInput.value = address;
        });
      } else if (!dropoffInput.value) {
        setDropoffLocation(location);
        geocodeLocation(location, (address) => {
          dropoffInput.value = address;
        });
      } else {
        // Both fields filled, ask user which to update
        if (confirm("Both locations are set. Click OK to update pickup, Cancel to update dropoff.")) {
          setPickupLocation(location);
          geocodeLocation(location, (address) => {
            pickupInput.value = address;
          });
        } else {
          setDropoffLocation(location);
          geocodeLocation(location, (address) => {
            dropoffInput.value = address;
          });
        }
      }
    }

    // Set pickup location with marker
    function setPickupLocation(location) {
      if (pickupMarker) {
        pickupMarker.setMap(null);
      }

      pickupMarker = new google.maps.Marker({
        position: location,
        map: map,
        title: "Pickup Location",
        icon: {
          url: 'https://maps.google.com/mapfiles/ms/icons/green-dot.png'
        }
      });

      if (dropoffMarker) {
        calculateRoute();
      }
    }

    // Set dropoff location with marker
    function setDropoffLocation(location) {
      if (dropoffMarker) {
        dropoffMarker.setMap(null);
      }

      dropoffMarker = new google.maps.Marker({
        position: location,
        map: map,
        title: "Dropoff Location",
        icon: {
          url: 'https://maps.google.com/mapfiles/ms/icons/red-dot.png'
        }
      });

      if (pickupMarker) {
        calculateRoute();
      }
    }

    // Geocode coordinates to address
    function geocodeLocation(location, callback) {
      geocoder.geocode({ location: location }, (results, status) => {
        if (status === "OK" && results[0]) {
          callback(results[0].formatted_address);
        } else {
          callback(`${location.lat().toFixed(6)}, ${location.lng().toFixed(6)}`);
        }
      });
    }

    // Calculate and display route
    function calculateRoute() {
      if (!pickupMarker || !dropoffMarker) return;

      const request = {
        origin: pickupMarker.getPosition(),
        destination: dropoffMarker.getPosition(),
        travelMode: google.maps.TravelMode.DRIVING,
      };

      directionsService.route(request, (result, status) => {
        if (status === "OK") {
          directionsRenderer.setDirections(result);

          // Calculate estimated time
          const route = result.routes[0];
          const leg = route.legs[0];
          showStatus(`üìç Route calculated! Distance: ${leg.distance.text}, Time: ${leg.duration.text}`, "success");
        } else {
          showStatus("‚ùå Could not calculate route. Please try different locations.", "error");
        }
      });
    }

    // Handle form submission
    document.getElementById('rideRequest').addEventListener('submit', function (e) {
      e.preventDefault();

      const pickup = document.getElementById('pickup').value;
      const dropoff = document.getElementById('dropoff').value;

      if (!pickup || !dropoff) {
        showStatus("‚ö†Ô∏è Please enter both pickup and dropoff locations.", "error");
        return;
      }

      // Simulate ride booking
      bookRide(pickup, dropoff);
    });

    // Simulate ride booking
    function bookRide(pickup, dropoff) {
      showStatus("üîÑ Booking your ride...", "info");

      // Simulate API call delay
      setTimeout(() => {
        const drivers = ['Alex Johnson', 'Sarah Smith', 'Mike Wilson', 'Emma Davis', 'Chris Brown'];
        const randomDriver = drivers[Math.floor(Math.random() * drivers.length)];
        const estimatedTime = Math.floor(Math.random() * 15) + 5; // 5-20 minutes

        // Show ride confirmation
        document.getElementById('confirmedPickup').textContent = pickup;
        document.getElementById('confirmedDropoff').textContent = dropoff;
        document.getElementById('estimatedTime').textContent = `${estimatedTime} minutes`;
        document.getElementById('driverName').textContent = randomDriver;
        document.getElementById('rideInfo').classList.add('active');

        showStatus(`üéâ Ride booked! ${randomDriver} will pick you up in ${estimatedTime} minutes.`, "success");
      }, 2000);
    }

    // Show status messages
    function showStatus(message, type) {
      const statusDiv = document.getElementById('status');
      statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;

      // Auto-hide after 5 seconds for success/error messages
      if (type !== 'info') {
        setTimeout(() => {
          statusDiv.innerHTML = '';
        }, 5000);
      }
    }

    // Error handling
    window.gm_authFailure = function () {
      showStatus('‚ùå Google Maps authentication failed. Please check your API key.', 'error');
    };

    // Make initMap globally accessible
    window.initMap = initMap;
  </script>

  <!-- Load Google Maps API with Places library -->
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyATtSPsIlPqphVIebyCKgT3MuW1RQERKcc&libraries=places&callback=initMap"
    onerror="document.getElementById('map').innerHTML='<div style=\'padding: 20px; text-align: center; color: red;\'><h3>Failed to Load Google Maps</h3><p>Please check your internet connection and API key.</p></div>'">
    </script>
</body>

</html>